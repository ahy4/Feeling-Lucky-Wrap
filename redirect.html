<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>Google Search Wrap</title>
</head>
<body>
  <script>
    const isRedirect = JSON.parse(localStorage.getItem('isRedirect'));
    const query = location.hash.replace('#', ''); // 取り除くシャープは最初の一個だけ
    const generalSearchUrl = `http://www.google.com/search?q=${query}`
    const feelingLuckyUrl = `http://www.google.com/search?hl=ja&btnI=I%27m+Feeling+Lucky&q=${query}`;
    const title = `${query} - Google 検索`;

    localStorage.setItem('isRedirect', false);

    document.getElementsByTagName('title')[0].innerText = title;

    if (isRedirect) {
      history.pushState(null, null, './')
      location.replace(feelingLuckyUrl);
    } else {
      location.replace(generalSearchUrl);
    }
  </script>
</body>
</html>
